(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2556a536"],{"26ae":function(e,t,o){},"8cce":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("Card",{staticStyle:{"margin-bottom":"10px"},attrs:{bordered:!1,"dis-hover":""}},[o("div",{staticClass:"category-btn-list"},[o("Form",{ref:"search",attrs:{model:e.roleData.search,"label-width":100}},[o("Row",[o("Col",{attrs:{span:"6"}},[o("FormItem",{attrs:{label:"关键字：",prop:"keys"}},[o("Input",{attrs:{type:"text",placeholder:"请输入关键字"},model:{value:e.roleData.search.keys,callback:function(t){e.$set(e.roleData.search,"keys",t)},expression:"roleData.search.keys"}})],1)],1),o("Col",{attrs:{span:"6"}},[o("FormItem",{attrs:{label:"状态：",prop:"status"}},[o("Select",{model:{value:e.roleData.search.status,callback:function(t){e.$set(e.roleData.search,"status",t)},expression:"roleData.search.status"}},[o("Option",{attrs:{value:""}},[e._v("全部")]),o("Option",{attrs:{value:"1"}},[e._v("已启用")]),o("Option",{attrs:{value:"2"}},[e._v("已禁用")])],1)],1)],1),o("Col",{attrs:{span:"8"}},[o("FormItem",[o("Col",{attrs:{span:"4"}},[o("Button",{attrs:{type:"primary"},on:{click:function(t){return e.searchClick("1")}}},[e._v("搜索")])],1),o("Col",{attrs:{span:"4"}},[o("Button",{attrs:{type:"default"},on:{click:function(t){return e.searchClick("2")}}},[e._v("重置")])],1)],1)],1)],1)],1)],1)]),o("Card",{attrs:{bordered:!1,"dis-hover":""}},[o("div",{staticClass:"category-btn-list"},[o("Button",{directives:[{name:"auth",rawName:"v-auth",value:"add_role",expression:"`add_role`"}],staticStyle:{"margin-right":"10px"},attrs:{type:"primary",icon:"md-add"},on:{click:function(t){return e.addModeShow(1,"")}}},[e._v("添加角色")])],1),o("Table",{attrs:{border:!1,columns:e.roleData.columns,data:e.roleData.list,loading:e.roleData.loading},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.row,s=t.index;return[1==a.type?o("div",[o("span",{staticStyle:{color:"#c5c8ce"}},[e._v("超级管理员无法操作")])]):o("div",[o("span",{directives:[{name:"auth",rawName:"v-auth",value:"add_role",expression:"`add_role`"}],staticClass:"span-but-list",on:{click:function(t){return e.addModeShow(2,a.id)}}},[e._v("编辑 | ")]),o("Poptip",{directives:[{name:"auth",rawName:"v-auth",value:"del_role",expression:"`del_role`"}],attrs:{transfer:"",confirm:"",title:"确定删除此角色?"},on:{"on-ok":function(t){return e.deleteMenu(a.id,s)}}},[o("span",{staticClass:"span-but-list"},[e._v("删除")])]),e._v(" | "),o("span",{directives:[{name:"auth",rawName:"v-auth",value:"add_role_permis",expression:"`add_role_permis`"}],staticClass:"span-but-list",on:{click:function(t){return e.showWebRoleModel(1,a.id)}}},[e._v("整站权限设置 | ")]),o("span",{staticClass:"span-but-list"},[e._v("栏目权限设置")])],1)]}}])}),o("div",{staticClass:"page-box"},[o("Page",{attrs:{total:e.roleData.count,"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.rolePageChange,"on-page-size-change":e.rolePageSizeChange}})],1)],1),o("Modal",{attrs:{loading:e.modeAdd.loading,title:e.modeAdd.title,closable:!1,"mask-closable":!1},on:{"on-cancel":function(t){e.event.model=!1},"on-ok":e.addMode},model:{value:e.modeAdd.show,callback:function(t){e.$set(e.modeAdd,"show",t)},expression:"modeAdd.show"}},[o("Form",{ref:"formValidate",attrs:{model:e.modeAdd.formInline,rules:e.modeAdd.ruleValidate,"label-width":95}},[o("FormItem",{attrs:{label:"角色名称",prop:"name"}},[o("Input",{attrs:{type:"text",placeholder:"角色名称最多8个字符"},model:{value:e.modeAdd.formInline.name,callback:function(t){e.$set(e.modeAdd.formInline,"name",t)},expression:"modeAdd.formInline.name"}})],1),o("FormItem",{attrs:{label:"角色描述",prop:"mark"}},[o("Input",{attrs:{placeholder:"角色描述最多30个字符"},model:{value:e.modeAdd.formInline.mark,callback:function(t){e.$set(e.modeAdd.formInline,"mark",t)},expression:"modeAdd.formInline.mark"}})],1),o("FormItem",{attrs:{label:"状态",prop:"status"}},[o("RadioGroup",{attrs:{"true-value":Number,"false-value":Number},model:{value:e.modeAdd.formInline.status,callback:function(t){e.$set(e.modeAdd.formInline,"status",t)},expression:"modeAdd.formInline.status"}},[o("Radio",{attrs:{label:"1"}},[e._v("启用")]),o("Radio",{attrs:{label:"2"}},[e._v("禁用")])],1)],1)],1),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{on:{click:function(t){return e.addModeShow(3,"")}}},[e._v("取消")]),o("Button",{attrs:{type:"primary",loading:e.modeAdd.loading},on:{click:function(t){return e.addMode("formValidate")}}},[e._v("确定")])],1)],1),o("WebPermissionList",{ref:"WebPermissionListModel"})],1)},s=[],n=(o("b526"),o("c368"),o("12ae"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("Modal",{attrs:{width:"800px",title:"站点页面权限列表",closable:!1,"mask-closable":!1},model:{value:e.roleModel.show,callback:function(t){e.$set(e.roleModel,"show",t)},expression:"roleModel.show"}},[o("div",{staticStyle:{"overflow-y":"auto",height:"500px"},attrs:{slot:""},slot:"default"},e._l(e.roleModel.items,(function(t,a){return o("Card",{key:a,staticStyle:{"margin-bottom":"10px"},attrs:{"dis-hover":!0,bordered:!0}},[o("p",{attrs:{slot:"title"},slot:"title"},[o("span",{staticStyle:{"font-size":"14px"}},[e._v(e._s(t.all_parent_title))])]),o("p",[o("Row",e._l(t.pagePermissionList,(function(t,a){return o("Col",{key:a,staticStyle:{"margin-bottom":"10px"},attrs:{span:"6"}},[o("Checkbox",{model:{value:t.checked,callback:function(o){e.$set(t,"checked",o)},expression:"item1.checked"}},[o("span",{staticStyle:{"font-size":"14px","margin-bottom":"10px"}},[e._v(e._s(t.title))])])],1)})),1)],1)])})),1),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{on:{click:function(t){return e.showWebRoleModel(2,"")}}},[e._v("取消")]),o("Button",{attrs:{type:"primary",loading:e.roleModel.okBtnLoading},on:{click:function(t){return e.addRolePermission("formValidate")}}},[e._v("确定")])],1)])],1)}),i=[],r=(o("1564"),{data:function(){return{roleId:"",roleModel:{listLoading:!0,okBtnLoading:!1,show:!1,items:[]},permissionsData:{urlItems:[],menuIdItems:[],permissionItems:[]}}},methods:{getRoleMenuList:function(e){var t=this,o=function(e){t.roleModel.listLoading=!1,t.roleModel.items=e.data.data},a=function(e){t.roleModel.listLoading=!1,t.roleModel.items=[],t.$Message.error({content:"权限列表菜单数据获取失败"})};t.HTTPJS.get(t.HTTPURL.SYSTEM_SEETING.MENU.GET_ROLE_PAGE_PERMISSION_ITEM,{roleId:e},o,a)},addRolePermission:function(){var e=this;e.getCheckMenuId(),e.roleModel.okBtnLoading=!0;var t=function(t){e.$Message.info({content:t.data.message,onClose:function(){e.roleModel.okBtnLoading=!1,e.showWebRoleModel(2)}})},o=function(t){e.$Message.error({content:t.data.message,onClose:function(){e.roleModel.okBtnLoading=!1}})};e.HTTPJS.post(e.HTTPURL.SYSTEM_SEETING.ROLE.ADD_ROLE_PERMISSION,{roleId:e.roleId,permissionsData:e.permissionsData},t,o)},getCheckMenuId:function(){var e=this;e.permissionsData.urlItems=[],e.permissionsData.menuIdItems=[],e.permissionsData.permissionItems=[];var t=e.roleModel.items;t.map((function(t,o,a){t.pagePermissionList.map((function(o,a,s){void 0!=o.checked&&!0===o.checked&&(e.permissionsData.menuIdItems.push(t.all_parent_id),e.permissionsData.permissionItems.push(o.id),e.permissionsData.urlItems.push(o.url))}))}))},showWebRoleModel:function(e,t){1==e?(this.roleModel.show=!0,this.roleId=t,this.getRoleMenuList(t)):(this.roleModel.show=!1,this.roleModel.okBtnLoading=!1)}}}),l=r,d=o("c701"),c=Object(d["a"])(l,n,i,!1,null,null,null),u=c.exports,m={components:{WebPermissionList:u},data:function(){var e=this;return{modeAdd:{show:!1,loading:!1,title:"添加角色",formInline:{id:"",is_add:1,name:"",mark:"",status:"1"},ruleValidate:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{type:"string",max:6,message:"角色名称最多8个字符",trigger:"blur"}],mark:[{type:"string",max:30,message:"角色描述最多30个字符",trigger:"blur"}]}},roleData:{loading:!0,search:{page:1,keys:"",status:"",pageSize:this.COMMONJS.pageSize},count:0,list:[],columns:[{title:"ID",key:"id",width:100,align:"center"},{title:"角色名称",key:"name",width:400,align:"left"},{title:"备注",key:"mark",width:400,align:"left"},{title:"状态",key:"status",width:200,align:"center",render:function(t,o){var a=e.roleData.list;return a[o.index].status==e.COMMONJS.roleStatus.oneStatus?t("span",{style:{color:"#19be6b"}},"已启用"):t("span",{style:{color:"#ed4014"}},"已禁用")}},{title:"管理操作",slot:"action",align:"center",key:"action"}]}}},activated:function(){this.getRoleList()},methods:{rolePageChange:function(e){this.roleData.loading=!0,this.roleData.search.page=e,this.getRoleList()},rolePageSizeChange:function(e){this.roleData.loading=!0,this.roleData.search.pageSize=e,this.getRoleList()},getRoleList:function(){var e=this,t=function(t){e.roleData.loading=!1,e.roleData.count=t.data.data.count,e.roleData.list=t.data.data.list},o=function(t){e.roleData.loading=!1};e.HTTPJS.get(e.HTTPURL.SYSTEM_SEETING.ROLE.GET_ROLE_LIST,e.roleData.search,t,o)},addModeShow:function(e,t){1==e?(this.modeAdd.show=!0,this.modeAdd.title="添加角色"):2==e?(this.modeAdd.title="编辑角色",this.getRoleInfo(t),this.modeAdd.formInline.id=t,this.modeAdd.formInline.is_add=2,this.modeAdd.show=!0):(this.modeAdd.title="添加角色",this.modeAdd.show=!1,this.$refs["formValidate"].resetFields())},getRoleInfo:function(e){var t=this,o=function(e){t.modeAdd.formInline=e.data.data},a=function(e){t.$Message.error({content:"数据获取失败"})};t.HTTPJS.get(t.HTTPURL.SYSTEM_SEETING.ROLE.GET_ROLE_INFO,{id:e},o,a)},addMode:function(e){var t=this;this.$refs[e].validate((function(e,o){if(e){t.modeAdd.loading=!0;var a=function(e){t.$Message.info({content:e.data.message,onClose:function(){t.modeAdd.loading=!1,t.getRoleList(),t.addModeShow(3)}})},s=function(e){t.$Message.error({content:e.data.message,onClose:function(){t.modeAdd.loading=!1}})};t.HTTPJS.post(t.HTTPURL.SYSTEM_SEETING.ROLE.ADD_ROLE,t.modeAdd.formInline,a,s)}}))},deleteMenu:function(e,t){var o=this,a=function(e){o.$Message.info({content:"删除成功",onClose:function(){o.roleData.list.splice(t,1)}})},s=function(e){o.$Message.error(e.data.message)};o.HTTPJS.post(o.HTTPURL.SYSTEM_SEETING.ROLE.DELETE_ROLE,{id:e},a,s)},searchClick:function(e){1==e?(this.roleData.search.page=1,this.roleData.list=[],this.roleData.loading=!0,this.getRoleList()):(this.roleData.search.page=1,this.roleData.list=[],this.roleData.loading=!0,this.$refs["search"].resetFields(),this.getRoleList())},showWebRoleModel:function(e,t){this.$refs.WebPermissionListModel.showWebRoleModel(e,t)}}},h=m,f=(o("d1a5"),Object(d["a"])(h,a,s,!1,null,"70b60de8",null));t["default"]=f.exports},b526:function(e,t,o){"use strict";var a=o("485e"),s=o("fd0b"),n=o("b804"),i=o("4a35"),r=o("3c6b"),l=o("0c3a"),d=o("bab6"),c=o("243e"),u=o("64f1"),m=c("splice"),h=u("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,p=Math.min,g=9007199254740991,v="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m||!h},{splice:function(e,t){var o,a,c,u,m,h,b=r(this),M=i(b.length),_=s(e,M),k=arguments.length;if(0===k?o=a=0:1===k?(o=0,a=M-_):(o=k-2,a=p(f(n(t),0),M-_)),M+o-a>g)throw TypeError(v);for(c=l(b,a),u=0;u<a;u++)m=_+u,m in b&&d(c,u,b[m]);if(c.length=a,o<a){for(u=_;u<M-a;u++)m=u+a,h=u+o,m in b?b[h]=b[m]:delete b[h];for(u=M;u>M-a+o;u--)delete b[u-1]}else if(o>a)for(u=M-a;u>_;u--)m=u+a-1,h=u+o-1,m in b?b[h]=b[m]:delete b[h];for(u=0;u<o;u++)b[u+_]=arguments[u+2];return b.length=M-a+o,c}})},bab6:function(e,t,o){"use strict";var a=o("bab3"),s=o("30cf"),n=o("ef69");e.exports=function(e,t,o){var i=a(t);i in e?s.f(e,i,n(0,o)):e[i]=o}},d1a5:function(e,t,o){"use strict";o("26ae")}}]);
//# sourceMappingURL=chunk-2556a536.ac373160.js.map